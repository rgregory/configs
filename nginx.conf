daemon off;
user  apache;
worker_processes  1;
worker_rlimit_nofile 65000;

events {
  worker_connections  2048;
	use epoll;
	multi_accept on;
}


http {
  include       mime.types;
  default_type  application/octet-stream;

  error_log /dev/stdout;
  access_log off;

  sendfile on;
  tcp_nopush on;
  tcp_nodelay on; 
  keepalive_timeout 30;
  keepalive_requests 100000;
  client_header_timeout 20;
  client_body_timeout 20;
  send_timeout 20;
  reset_timedout_connection on;

  gzip on;
  gzip_proxied any;
  gzip_min_length 256;
  gzip_proxied expired no-cache no-store private auth;
  gzip_types text/plain text/css text/xml text/javascript application/x-javascript application/xml;
  gzip_disable "MSIE [1-6]\.";

  open_file_cache max=200000 inactive=20s; 
  open_file_cache_valid 30s; 
  open_file_cache_min_uses 2;
  open_file_cache_errors on;

  upstream django {
    server 127.0.0.1:8001;
  }

  server {
    listen       80;
    server_name  localhost;
    charset utf-8;

    # Photomap site
    location /photomaps/ {
      uwsgi_pass  django;
      include     /usr/local/nginx/conf/uwsgi_params; 
    }

    error_page  404              /404.html;
    error_page   500 502 503 504  /50x.html;
    
    location = /50x.html {
      root   html;
    }

# proxy the PHP scripts to Apache listening on 127.0.0.1:80
#
#location ~ \.php$ {
#    proxy_pass   http://127.0.0.1;
#}

# pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
#
#location ~ \.php$ {
#    root           html;
#    fastcgi_pass   127.0.0.1:9000;
#    fastcgi_index  index.php;
#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;
#    include        fastcgi_params;
#}

# deny access to .htaccess files, if Apache's document root
# concurs with nginx's one
#
    location ~ /\.ht {
      deny  all;
    }

    location ~ /\.svn {
      deny all;
    }	
  }


}
